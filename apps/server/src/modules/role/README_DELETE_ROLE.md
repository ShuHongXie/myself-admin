# 删除角色功能实现说明

## 功能概述
已为角色管理模块添加了删除角色的功能，包含以下特性：

## API 接口
- **路径**: `DELETE /role/:id`
- **描述**: 删除指定ID的角色
- **参数**: id (路径参数) - 角色ID

## 业务逻辑

### 1. 角色存在性检查
- 检查指定ID的角色是否存在
- 如果不存在，返回"角色不存在"错误

### 2. 关联用户检查
- 检查是否有用户关联此角色
- 如果存在关联用户，返回"该角色下还有用户，无法删除"错误
- 确保数据的完整性和安全性

### 3. 级联删除处理
- 删除角色时会自动处理角色-菜单关系表的数据
- 通过 TypeORM 的级联删除 (`onDelete: 'CASCADE'`) 自动处理

## 错误处理
- 角色不存在：返回通用错误码和相应提示
- 有用户关联：返回通用错误码和相应提示  
- 系统异常：返回系统异常错误码

## 安全考虑
1. **数据完整性**：删除前检查关联关系，防止数据不一致
2. **级联处理**：自动清理相关表数据
3. **错误处理**：完善的异常捕获和错误信息返回

## 使用示例

### 成功删除
```
DELETE /role/1
```
返回：
```json
{
  "code": 200,
  "message": "删除成功",
  "data": null
}
```

### 角色不存在
```
DELETE /role/999
```
返回：
```json
{
  "code": 20000,
  "message": "角色不存在"
}
```

### 有用户关联
```
DELETE /role/1
```
返回：
```json
{
  "code": 20000,
  "message": "该角色下还有用户，无法删除"
}
```

## 代码位置
- 控制器：`apps/server/src/modules/role/role.controller.ts`
- 服务层：`apps/server/src/modules/role/role.service.ts`

## 注意事项
1. 删除操作不可逆，建议在前端添加二次确认
2. 建议在删除前向用户展示关联的用户信息
3. 可以考虑实现软删除（标记为删除而非物理删除）